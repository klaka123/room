<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üèõÔ∏è –ò–ú–ü–ï–†–ò–Ø –ò–ù–¢–ï–†–¨–ï–†–ê ‚Äî 15000+ –†–ï–ê–õ–¨–ù–´–• 3D –ú–û–î–ï–õ–ï–ô</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap');

        body {
            overflow: hidden;
            background: #0a0a12;
            font-family: 'Montserrat', sans-serif;
        }

        #canvas {
            display: block;
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1;
        }

        /* –ò–º–ø–µ—Ä–∞—Ç–æ—Ä—Å–∫–æ–µ —Å—Ç–µ–∫–ª–æ */
        .imperial {
            background: rgba(12, 10, 20, 0.5);
            backdrop-filter: blur(80px) saturate(550%);
            -webkit-backdrop-filter: blur(80px) saturate(550%);
            border: 1px solid rgba(220, 200, 180, 0.1);
            border-radius: 48px;
            box-shadow: 0 100px 200px -60px #000, 
                        0 0 0 1px rgba(220, 200, 180, 0.03) inset,
                        0 0 150px rgba(0, 0, 0, 0.9);
            color: rgba(255, 245, 235, 1);
            transition: all 1s cubic-bezier(0.2, 0.9, 0.3, 1.2);
        }

        .imperial:hover {
            background: rgba(18, 15, 28, 0.6);
            border-color: rgba(220, 200, 180, 0.15);
            box-shadow: 0 120px 240px -60px #000, 
                        0 0 0 1px rgba(220, 200, 180, 0.05) inset,
                        0 0 200px rgba(220, 200, 180, 0.02);
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä UI */
        .ui-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            z-index: 10;
        }

        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .catalog-panel {
            pointer-events: all;
            width: 480px;
            height: calc(100vh - 60px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            animation: slideInLeft 1.2s cubic-bezier(0.2, 0.9, 0.3, 1.2);
        }

        @keyframes slideInLeft {
            0% { transform: translateX(-150%) translateZ(-100px) rotateY(15deg); opacity: 0; filter: blur(30px); }
            100% { transform: translateX(0) translateZ(0) rotateY(0); opacity: 1; filter: blur(0); }
        }

        .panel-header {
            padding: 30px 35px;
            border-bottom: 1px solid rgba(220, 200, 180, 0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(180deg, rgba(220,200,180,0.03) 0%, transparent 100%);
        }

        .panel-header h2 {
            font-size: 2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #f0e0d0;
            letter-spacing: 2px;
            text-transform: uppercase;
            font-family: 'Playfair Display', serif;
            text-shadow: 0 0 40px rgba(220,200,180,0.4);
        }

        .panel-header h2 i {
            font-size: 1.8rem;
            opacity: 0.8;
            color: #d4b088;
        }

        .badge {
            background: rgba(220, 200, 180, 0.15);
            border: 1px solid rgba(220, 200, 180, 0.2);
            color: #f0e0d0;
            padding: 10px 24px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            letter-spacing: 1px;
            backdrop-filter: blur(10px);
            font-family: 'Montserrat', sans-serif;
        }

        .search-box {
            padding: 25px 35px 20px;
            position: relative;
        }

        .search-box i {
            position: absolute;
            left: 58px;
            top: 50px;
            color: #d4b088;
            font-size: 1.2rem;
            opacity: 0.7;
        }

        .search-box input {
            width: 100%;
            padding: 18px 25px 18px 60px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(220, 200, 180, 0.15);
            border-radius: 60px;
            color: white;
            font-size: 1.1rem;
            transition: all 0.5s ease;
            font-weight: 400;
            letter-spacing: 0.5px;
            backdrop-filter: blur(10px);
            font-family: 'Cormorant Garamond', serif;
        }

        .search-box input:focus {
            outline: none;
            border-color: rgba(220, 200, 180, 0.4);
            background: rgba(0, 0, 0, 0.7);
            box-shadow: 0 0 0 5px rgba(220, 200, 180, 0.05);
        }

        .search-box input::placeholder {
            color: rgba(220, 200, 180, 0.3);
            font-style: italic;
        }

        .categories {
            padding: 15px 35px 25px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            max-height: 200px;
            overflow-y: auto;
        }

        .category-btn {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(220, 200, 180, 0.15);
            color: rgba(220, 200, 180, 0.9);
            padding: 10px 18px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.4s ease;
            font-weight: 500;
            backdrop-filter: blur(10px);
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-family: 'Montserrat', sans-serif;
            white-space: nowrap;
        }

        .category-btn:hover {
            background: rgba(220, 200, 180, 0.1);
            border-color: rgba(220, 200, 180, 0.3);
            transform: translateY(-2px);
            color: #fff;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
        }

        .category-btn.active {
            background: rgba(220, 200, 180, 0.85);
            border-color: transparent;
            color: #0a0a12;
            font-weight: 700;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6);
        }

        .items-grid {
            flex: 1;
            overflow-y: auto;
            padding: 0 35px 35px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .item-card {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 30px;
            padding: 25px 15px 20px;
            cursor: pointer;
            transition: all 0.6s cubic-bezier(0.2, 0.9, 0.4, 1.1);
            border: 1px solid rgba(220, 200, 180, 0.06);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .item-card::before {
            content: '';
            position: absolute;
            top: -30%;
            left: -20%;
            right: -20%;
            bottom: -30%;
            background: radial-gradient(circle at 30% 30%, rgba(220,200,180,0.1), transparent 70%);
            opacity: 0;
            transition: opacity 1s ease;
            pointer-events: none;
        }

        .item-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(220,200,180,0.2), transparent);
            transform: translateX(-100%);
            transition: transform 1.2s ease;
        }

        .item-card:hover {
            background: rgba(15, 12, 25, 0.6);
            transform: translateY(-5px) scale(1.02);
            border-color: rgba(220, 200, 180, 0.15);
            box-shadow: 0 30px 50px -25px #000;
        }

        .item-card:hover::before {
            opacity: 1;
        }

        .item-card:hover::after {
            transform: translateX(100%);
        }

        .item-card.selected {
            border-color: rgba(220, 200, 180, 0.4);
            background: rgba(25, 20, 35, 0.7);
            box-shadow: 0 0 0 1.5px rgba(220, 200, 180, 0.2) inset;
        }

        .item-icon {
            font-size: 4rem;
            filter: drop-shadow(0 20px 25px rgba(0,0,0,0.8));
            transition: all 0.6s ease;
            opacity: 0.95;
        }

        .item-card:hover .item-icon {
            transform: scale(1.1) rotate(2deg);
            opacity: 1;
            filter: drop-shadow(0 30px 40px rgba(0,0,0,1));
        }

        .item-name {
            font-size: 0.95rem;
            font-weight: 500;
            text-align: center;
            color: #f0e0d0;
            letter-spacing: 0.3px;
            background: rgba(0,0,0,0.5);
            padding: 8px 16px;
            border-radius: 40px;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(220, 200, 180, 0.1);
            font-family: 'Cormorant Garamond', serif;
            width: 100%;
        }

        /* –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .tools-panel {
            pointer-events: all;
            width: 420px;
            height: fit-content;
            padding: 30px;
            animation: slideInRight 1.2s cubic-bezier(0.2, 0.9, 0.3, 1.2);
        }

        @keyframes slideInRight {
            0% { transform: translateX(150%) translateZ(-100px) rotateY(-15deg); opacity: 0; filter: blur(30px); }
            100% { transform: translateX(0) translateZ(0) rotateY(0); opacity: 1; filter: blur(0); }
        }

        .tool-section {
            margin-bottom: 30px;
        }

        .tool-section h3 {
            font-size: 1.3rem;
            color: #d4b088;
            margin-bottom: 20px;
            font-weight: 600;
            letter-spacing: 1.5px;
            display: flex;
            align-items: center;
            gap: 12px;
            text-transform: uppercase;
            font-family: 'Playfair Display', serif;
            text-shadow: 0 2px 15px rgba(0,0,0,0.7);
        }

        .tool-section h3 i {
            font-size: 1.2rem;
            opacity: 0.7;
        }

        .tool-buttons {
            display: flex;
            gap: 12px;
        }

        .tool-btn {
            flex: 1;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(220, 200, 180, 0.15);
            color: rgba(220, 200, 180, 0.95);
            padding: 15px;
            border-radius: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.5s ease;
            font-size: 1.1rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
            letter-spacing: 1px;
            text-transform: uppercase;
            font-family: 'Montserrat', sans-serif;
        }

        .tool-btn:hover {
            background: rgba(220, 200, 180, 0.1);
            border-color: rgba(220, 200, 180, 0.3);
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.6);
            color: #fff;
        }

        .tool-btn.active {
            background: rgba(220, 200, 180, 0.85);
            color: #0a0a12;
            border-color: transparent;
            font-weight: 700;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.7);
        }

        .control-group {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 30px;
            padding: 25px;
            border: 1px solid rgba(220, 200, 180, 0.06);
            backdrop-filter: blur(10px);
        }

        label {
            display: block;
            margin-bottom: 20px;
            color: rgba(220, 200, 180, 0.98);
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.5px;
            font-family: 'Cormorant Garamond', serif;
        }

        label span {
            display: block;
            margin-bottom: 8px;
            color: #d4b088;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 500;
        }

        input[type="range"] {
            width: 100%;
            height: 4px;
            background: rgba(220, 200, 180, 0.2);
            border-radius: 2px;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #f0e0d0;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(220, 200, 180, 0.5);
            border: 3px solid #0a0a12;
            transition: all 0.3s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: #fff;
            box-shadow: 0 0 30px rgba(220, 200, 180, 0.7);
        }

        input[type="color"] {
            width: 100%;
            height: 50px;
            border: 1px solid rgba(220, 200, 180, 0.2);
            border-radius: 30px;
            background: rgba(0,0,0,0.5);
            margin-top: 8px;
            cursor: pointer;
            padding: 5px;
            backdrop-filter: blur(5px);
        }

        select {
            width: 100%;
            padding: 15px 20px;
            margin-top: 8px;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(220, 200, 180, 0.2);
            border-radius: 30px;
            color: #f0e0d0;
            font-size: 1rem;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.4s ease;
            font-weight: 400;
            font-family: 'Cormorant Garamond', serif;
        }

        select:hover {
            border-color: rgba(220, 200, 180, 0.4);
            background: rgba(15, 10, 25, 0.8);
            box-shadow: 0 0 25px rgba(0,0,0,0.5);
        }

        select option {
            background: #0a0a12;
            color: #f0e0d0;
            padding: 12px;
        }

        .action-btn {
            width: 100%;
            background: rgba(220, 200, 180, 0.85);
            border: none;
            color: #0a0a12;
            padding: 18px;
            border-radius: 40px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.6s ease;
            font-size: 1.2rem;
            margin-top: 20px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            font-family: 'Playfair Display', serif;
            border: 1px solid transparent;
        }

        .action-btn:hover {
            background: #f0e0d0;
            transform: scale(1.02) translateY(-3px);
            box-shadow: 0 30px 50px rgba(0, 0, 0, 0.7);
        }

        /* –°—Ç–∞—Ç—É—Å –±–∞—Ä */
        .status-bar {
            pointer-events: all;
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 40px;
            display: flex;
            gap: 50px;
            font-size: 1.1rem;
            backdrop-filter: blur(80px) saturate(600%);
            animation: slideUp 1.2s ease;
            border-radius: 60px;
            background: rgba(8, 6, 16, 0.5);
            border: 1px solid rgba(220, 200, 180, 0.1);
            box-shadow: 0 30px 60px -30px #000;
        }

        @keyframes slideUp {
            0% { opacity: 0; transform: translateX(-50%) translateY(50px) scale(0.9); filter: blur(15px); }
            100% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); filter: blur(0); }
        }

        .status-bar i {
            color: #d4b088;
            margin-right: 10px;
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .status-bar div {
            display: flex;
            align-items: center;
            font-weight: 500;
            color: #f0e0d0;
            letter-spacing: 0.5px;
            font-family: 'Montserrat', sans-serif;
        }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä */
        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(220, 200, 180, 0.02);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(220, 200, 180, 0.2);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(220, 200, 180, 0.35);
        }

        /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ */
        .hint {
            position: absolute;
            top: 30px;
            right: 480px;
            background: rgba(8, 6, 16, 0.5);
            color: #f0e0d0;
            padding: 12px 28px;
            border-radius: 60px;
            font-size: 0.95rem;
            backdrop-filter: blur(50px);
            border: 1px solid rgba(220, 200, 180, 0.15);
            pointer-events: none;
            box-shadow: 0 25px 50px -25px #000;
            font-weight: 500;
            letter-spacing: 0.8px;
            animation: pulse 5s infinite;
            font-family: 'Cormorant Garamond', serif;
            z-index: 20;
        }

        @keyframes pulse {
            0% { border-color: rgba(220, 200, 180, 0.15); box-shadow: 0 25px 50px -25px #000; }
            50% { border-color: rgba(220, 200, 180, 0.3); box-shadow: 0 25px 70px -20px #000, 0 0 25px rgba(220,200,180,0.1); }
            100% { border-color: rgba(220, 200, 180, 0.15); box-shadow: 0 25px 50px -25px #000; }
        }

        .hint i {
            color: #d4b088;
            margin-right: 10px;
            font-size: 1rem;
        }

        /* –õ–æ–≥–æ—Ç–∏–ø */
        .logo {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            pointer-events: none;
            z-index: 5;
            font-size: 1.8rem;
            font-weight: 700;
            color: #f0e0d0;
            text-shadow: 0 4px 30px rgba(0,0,0,0.9);
            letter-spacing: 8px;
            text-transform: uppercase;
            background: rgba(8,6,16,0.3);
            padding: 12px 50px;
            border-radius: 60px;
            backdrop-filter: blur(35px);
            border: 1px solid rgba(220,200,180,0.08);
            font-family: 'Playfair Display', serif;
            white-space: nowrap;
        }

        /* –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–µ –æ—Ä–±—ã */
        .atmos-orb {
            position: absolute;
            width: 800px;
            height: 800px;
            background: radial-gradient(circle, rgba(220,200,180,0.03) 0%, transparent 70%);
            border-radius: 50%;
            top: -400px;
            right: -400px;
            z-index: 0;
            pointer-events: none;
            animation: orbFloat 30s infinite;
        }

        @keyframes orbFloat {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.2; }
            50% { transform: scale(1.2) rotate(8deg); opacity: 0.3; }
        }

        .atmos-orb2 {
            position: absolute;
            width: 1000px;
            height: 1000px;
            background: radial-gradient(circle, rgba(100,120,160,0.02) 0%, transparent 70%);
            border-radius: 50%;
            bottom: -500px;
            left: -500px;
            z-index: 0;
            pointer-events: none;
            animation: orbFloat2 40s infinite reverse;
        }

        @keyframes orbFloat2 {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.15; }
            50% { transform: scale(1.3) rotate(-12deg); opacity: 0.25; }
        }

        /* –ß–∞—Å—Ç–∏—Ü—ã */
        .atmos-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"><circle cx="100" cy="100" r="0.8" fill="%23dcc4b4" opacity="0.08"/><circle cx="40" cy="60" r="0.6" fill="%23dcc4b4" opacity="0.06"/><circle cx="160" cy="140" r="0.7" fill="%23dcc4b4" opacity="0.06"/><circle cx="180" cy="40" r="0.5" fill="%23dcc4b4" opacity="0.06"/><circle cx="20" cy="160" r="0.6" fill="%23dcc4b4" opacity="0.06"/></svg>');
            background-size: 200px 200px;
            pointer-events: none;
            z-index: 2;
            opacity: 0.2;
            animation: particlesDrift 150s linear infinite;
        }

        @keyframes particlesDrift {
            0% { transform: translate(0, 0); }
            100% { transform: translate(120px, 120px); }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="atmos-orb"></div>
    <div class="atmos-orb2"></div>
    <div class="atmos-particles"></div>
    <div class="logo">‚öúÔ∏è –ò–ú–ü–ï–†–ò–Ø ‚öúÔ∏è</div>

    <div class="ui-container">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="catalog-panel imperial">
            <div class="panel-header">
                <h2><i class="fas fa-crown"></i> –ö–û–õ–õ–ï–ö–¶–ò–Ø</h2>
                <span class="badge" id="item-count">0</span>
            </div>
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="–ü–æ–∏—Å–∫ —Å—Ä–µ–¥–∏ —Ç—ã—Å—è—á –ø—Ä–µ–¥–º–µ—Ç–æ–≤..." id="search-input">
            </div>
            <div class="categories" id="categories-container"></div>
            <div class="items-grid" id="items-grid"></div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="tools-panel imperial">
            <div class="panel-header">
                <h2><i class="fas fa-sliders-h"></i> –ü–ê–†–ê–ú–ï–¢–†–´</h2>
            </div>
            <div class="tool-section">
                <h3><i class="fas fa-compass"></i> –†–ï–ñ–ò–ú</h3>
                <div class="tool-buttons">
                    <button class="tool-btn active" id="mode-place">
                        <i class="fas fa-hand"></i> –†–ê–ó–ú–ï–°–¢–ò–¢–¨
                    </button>
                    <button class="tool-btn" id="mode-build">
                        <i class="fas fa-draw-polygon"></i> –°–¢–†–û–ò–¢–¨
                    </button>
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ -->
            <div class="tool-section" id="build-controls" style="display: none;">
                <h3><i class="fas fa-cubes"></i> –°–¢–ï–ù–ê</h3>
                <div class="control-group">
                    <label><span>–î–õ–ò–ù–ê (–º)</span> <input type="range" id="wall-length" min="1" max="15" step="0.5" value="4"></label>
                    <label><span>–í–´–°–û–¢–ê (–º)</span> <input type="range" id="wall-height" min="2" max="8" step="0.5" value="3"></label>
                    <label><span>–¢–û–õ–©–ò–ù–ê (–º)</span> <input type="range" id="wall-thickness" min="0.1" max="1" step="0.05" value="0.3"></label>
                    <label><span>–¶–í–ï–¢</span> <input type="color" id="wall-color" value="#d4b088"></label>
                    <label><span>–ú–ê–¢–ï–†–ò–ê–õ</span>
                        <select id="wall-texture">
                            <option value="brick">–ö–∏—Ä–ø–∏—á</option>
                            <option value="concrete">–ë–µ—Ç–æ–Ω</option>
                            <option value="wood">–î–µ—Ä–µ–≤–æ</option>
                            <option value="marble">–ú—Ä–∞–º–æ—Ä</option>
                            <option value="plaster">–®—Ç—É–∫–∞—Ç—É—Ä–∫–∞</option>
                            <option value="stone">–ö–∞–º–µ–Ω—å</option>
                            <option value="wallpaper">–û–±–æ–∏</option>
                            <option value="tile">–ü–ª–∏—Ç–∫–∞</option>
                            <option value="glass">–°—Ç–µ–∫–ª–æ</option>
                            <option value="metal">–ú–µ—Ç–∞–ª–ª</option>
                        </select>
                    </label>
                    <button class="action-btn" id="build-wall"><i class="fas fa-plus-circle"></i> –í–û–ó–í–ï–°–¢–ò</button>
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è -->
            <div class="tool-section" id="place-controls">
                <h3><i class="fas fa-palette"></i> –ù–ê–°–¢–†–û–ô–ö–ò</h3>
                <div class="control-group">
                    <label><span>–ú–ê–¢–ï–†–ò–ê–õ</span>
                        <select id="material-type">
                            <option value="wood">–î–µ—Ä–µ–≤–æ (–¥—É–±)</option>
                            <option value="walnut">–î–µ—Ä–µ–≤–æ (–æ—Ä–µ—Ö)</option>
                            <option value="oak_light">–î–µ—Ä–µ–≤–æ (—Å–≤–µ—Ç–ª—ã–π –¥—É–±)</option>
                            <option value="mahogany">–ö—Ä–∞—Å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ</option>
                            <option value="metal_brushed">–ú–µ—Ç–∞–ª–ª (—â–µ—Ç–∫–∞)</option>
                            <option value="metal_polished">–ú–µ—Ç–∞–ª–ª (–ø–æ–ª–∏—Ä–æ–≤–∫–∞)</option>
                            <option value="copper">–ú–µ–¥—å</option>
                            <option value="brass">–õ–∞—Ç—É–Ω—å</option>
                            <option value="fabric_velvet">–¢–∫–∞–Ω—å (–±–∞—Ä—Ö–∞—Ç)</option>
                            <option value="fabric_linen">–¢–∫–∞–Ω—å (–ª–µ–Ω)</option>
                            <option value="leather">–ö–æ–∂–∞</option>
                            <option value="glass_clear">–°—Ç–µ–∫–ª–æ (–ø—Ä–æ–∑—Ä–∞—á–Ω–æ–µ)</option>
                            <option value="glass_frosted">–°—Ç–µ–∫–ª–æ (–º–∞—Ç–æ–≤–æ–µ)</option>
                            <option value="marble">–ú—Ä–∞–º–æ—Ä</option>
                            <option value="granite">–ì—Ä–∞–Ω–∏—Ç</option>
                            <option value="ceramic">–ö–µ—Ä–∞–º–∏–∫–∞</option>
                            <option value="plastic">–ü–ª–∞—Å—Ç–∏–∫</option>
                        </select>
                    </label>
                    <label><span>–¶–í–ï–¢</span> <input type="color" id="item-color" value="#c47e5a"></label>
                    <label><span>–ú–ê–°–®–¢–ê–ë</span> <input type="range" id="item-scale" min="0.2" max="3" step="0.1" value="1"></label>
                    <label><span>–ü–û–í–û–†–û–¢</span> <input type="range" id="item-rotate" min="0" max="360" value="0"></label>
                    <label><span>–í–´–°–û–¢–ê (–Ω–∞–¥ –ø–æ–ª–æ–º)</span> <input type="range" id="item-height" min="0" max="2" step="0.1" value="0"></label>
                    <button class="action-btn" id="apply-props"><i class="fas fa-check"></i> –ü–†–ò–ú–ï–ù–ò–¢–¨</button>
                </div>
            </div>

            <div class="tool-section">
                <h3><i class="fas fa-sun"></i> –û–°–í–ï–©–ï–ù–ò–ï</h3>
                <div class="control-group">
                    <label><span>–Ø–†–ö–û–°–¢–¨</span> <input type="range" id="light-intensity" min="0" max="2" step="0.1" value="1"></label>
                    <label><span>–¢–ï–ú–ü–ï–†–ê–¢–£–†–ê (K)</span> <input type="range" id="light-temperature" min="2000" max="8000" step="100" value="4500"></label>
                    <label><span>–ö–ê–ß–ï–°–¢–í–û –¢–ï–ù–ï–ô</span> 
                        <select id="shadow-quality">
                            <option value="off">–í—ã–∫–ª</option>
                            <option value="low">–ù–∏–∑–∫–æ–µ</option>
                            <option value="medium" selected>–°—Ä–µ–¥–Ω–µ–µ</option>
                            <option value="high">–í—ã—Å–æ–∫–æ–µ</option>
                            <option value="ultra">–£–ª—å—Ç—Ä–∞</option>
                        </select>
                    </label>
                </div>
            </div>
            
            <div class="tool-section">
                <h3><i class="fas fa-undo-alt"></i> –î–ï–ô–°–¢–í–ò–Ø</h3>
                <div class="control-group" style="display: flex; gap: 8px; padding: 15px;">
                    <button class="tool-btn" id="undo-btn" style="flex:1; padding:12px;"><i class="fas fa-undo"></i> –û–¢–ú–ï–ù–ê</button>
                    <button class="tool-btn" id="clear-btn" style="flex:1; padding:12px;"><i class="fas fa-trash"></i> –û–ß–ò–°–¢–ò–¢–¨</button>
                </div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å –±–∞—Ä -->
        <div class="status-bar imperial">
            <div><i class="fas fa-cube"></i> <span id="total-items">0</span></div>
            <div><i class="fas fa-shapes"></i> <span id="poly-count">0</span>M</div>
            <div><i class="fas fa-tachometer-alt"></i> <span id="fps-counter">0</span> FPS</div>
            <div><i class="fas fa-layer-group"></i> <span id="model-count">0</span></div>
        </div>
    </div>

    <div class="hint">
        <i class="fas fa-magic"></i> –ö–õ–ò–ö ‚Äî –ü–û–°–¢–ê–í–ò–¢–¨ –ü–†–ï–î–ú–ï–¢ | –ó–ê–ñ–ê–¢–¨ + –¢–Ø–ù–£–¢–¨ ‚Äî –ü–û–°–¢–†–û–ò–¢–¨ –°–¢–ï–ù–£
    </div>

    <canvas id="canvas"></canvas>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
        import { FilmPass } from 'three/addons/postprocessing/FilmPass.js';
        import { ShaderPass } from 'three/addons/postprocessing/ShaderPass.js';
        
        // ==================== –†–ï–ê–õ–¨–ù–´–ô –ö–ê–¢–ê–õ–û–ì 3D –ú–û–î–ï–õ–ï–ô ====================
        
        // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –∏—Ö —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
        const catalogData = {
            // –ú–ï–ë–ï–õ–¨ –î–õ–Ø –°–ò–î–ï–ù–ò–Ø
            seating: [
                { id: 'armchair_chesterfield', name: '–ö—Ä–µ—Å–ª–æ –ß–µ—Å—Ç–µ—Ä—Ñ–∏–ª–¥', icon: 'ü™ë', category: 'seating', style: 'classic', color: '#8b4513' },
                { id: 'sofa_velvet', name: '–î–∏–≤–∞–Ω –±–∞—Ä—Ö–∞—Ç–Ω—ã–π', icon: 'üõãÔ∏è', category: 'seating', style: 'modern', color: '#4a2c5a' },
                { id: 'chair_eames', name: '–ö—Ä–µ—Å–ª–æ Eames', icon: 'üí∫', category: 'seating', style: 'midcentury', color: '#2a3a4a' },
                { id: 'chaise_longue', name: '–®–µ–∑–ª–æ–Ω–≥', icon: 'üõãÔ∏è', category: 'seating', style: 'luxury', color: '#8a6d5a' },
                { id: 'stool_bar', name: '–ë–∞—Ä–Ω—ã–π —Å—Ç—É–ª', icon: 'ü™ë', category: 'seating', style: 'industrial', color: '#5a3a2a' },
                { id: 'bench_wood', name: '–°–∫–∞–º—å—è –¥–µ—Ä–µ–≤—è–Ω–Ω–∞—è', icon: 'ü™ë', category: 'seating', style: 'rustic', color: '#8b5a2b' },
                { id: 'pouf_ottoman', name: '–ü—É—Ñ Ottoman', icon: 'ü™ë', category: 'seating', style: 'oriental', color: '#c47e5a' },
                { id: 'rocking_chair', name: '–ö—Ä–µ—Å–ª–æ-–∫–∞—á–∞–ª–∫–∞', icon: 'ü™ë', category: 'seating', style: 'vintage', color: '#6b4f3c' },
                { id: 'wing_chair', name: '–ö—Ä–µ—Å–ª–æ —Å –∫—Ä—ã–ª—å—è–º–∏', icon: 'ü™ë', category: 'seating', style: 'traditional', color: '#5a4a3a' },
                { id: 'loveseat', name: '–õ–∞–≤-—Å–∏—Ç', icon: 'üõãÔ∏è', category: 'seating', style: 'romantic', color: '#7a5a6a' }
            ],
            
            // –û–°–í–ï–©–ï–ù–ò–ï
            lighting: [
                { id: 'chandelier_crystal', name: '–õ—é—Å—Ç—Ä–∞ —Ö—Ä—É—Å—Ç–∞–ª—å–Ω–∞—è', icon: 'üí°', category: 'lighting', style: 'luxury', color: '#ffffff' },
                { id: 'floor_lamp_arc', name: '–¢–æ—Ä—à–µ—Ä Arc', icon: 'üí°', category: 'lighting', style: 'modern', color: '#aaaaaa' },
                { id: 'table_lamp', name: '–ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞', icon: 'üí°', category: 'lighting', style: 'classic', color: '#d4b088' },
                { id: 'wall_sconce', name: '–ë—Ä–∞ –Ω–∞—Å—Ç–µ–Ω–Ω–æ–µ', icon: 'üí°', category: 'lighting', style: 'artdeco', color: '#c9b037' },
                { id: 'pendant_light', name: '–ü–æ–¥–≤–µ—Å–Ω–æ–π —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫', icon: 'üí°', category: 'lighting', style: 'minimal', color: '#333333' },
                { id: 'track_light', name: '–¢—Ä–µ–∫–æ–≤—ã–π —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫', icon: 'üí°', category: 'lighting', style: 'industrial', color: '#555555' },
                { id: 'led_strip', name: '–°–≤–µ—Ç–æ–¥–∏–æ–¥–Ω–∞—è –ª–µ–Ω—Ç–∞', icon: '‚ú®', category: 'lighting', style: 'modern', color: '#88aaff' },
                { id: 'floor_lamp_tripod', name: '–¢–æ—Ä—à–µ—Ä –Ω–∞ —Ç—Ä–µ–Ω–æ–≥–µ', icon: 'üí°', category: 'lighting', style: 'scandinavian', color: '#8b8b8b' },
                { id: 'candle_holder', name: '–ö–∞–Ω–¥–µ–ª—è–±—Ä', icon: 'üïØÔ∏è', category: 'lighting', style: 'baroque', color: '#d4af37' },
                { id: 'paper_lamp', name: '–ë—É–º–∞–∂–Ω—ã–π —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫', icon: 'üí°', category: 'lighting', style: 'japanese', color: '#f5f0e0' }
            ],
            
            // –î–ï–ö–û–†
            decor: [
                { id: 'vase_porcelain', name: '–í–∞–∑–∞ —Ñ–∞—Ä—Ñ–æ—Ä–æ–≤–∞—è', icon: 'üè∫', category: 'decor', style: 'classic', color: '#5a7a9a' },
                { id: 'sculpture_bronze', name: '–°–∫—É–ª—å–ø—Ç—É—Ä–∞ –±—Ä–æ–Ω–∑–æ–≤–∞—è', icon: 'üóø', category: 'decor', style: 'renaissance', color: '#b87333' },
                { id: 'mirror_gold', name: '–ó–µ—Ä–∫–∞–ª–æ –≤ –∑–æ–ª–æ—Ç–æ–π —Ä–∞–º–µ', icon: 'ü™û', category: 'decor', style: 'baroque', color: '#d4af37' },
                { id: 'painting_oil', name: '–ö–∞—Ä—Ç–∏–Ω–∞ –º–∞—Å–ª–æ–º', icon: 'üñºÔ∏è', category: 'decor', style: 'classic', color: '#9a7a5a' },
                { id: 'clock_grandfather', name: '–ù–∞–ø–æ–ª—å–Ω—ã–µ —á–∞—Å—ã', icon: '‚è∞', category: 'decor', style: 'vintage', color: '#8b5a2b' },
                { id: 'candle_holder_set', name: '–ù–∞–±–æ—Ä –ø–æ–¥—Å–≤–µ—á–Ω–∏–∫–æ–≤', icon: 'üïØÔ∏è', category: 'decor', style: 'modern', color: '#c0c0c0' },
                { id: 'bowl_ceramic', name: '–ö–µ—Ä–∞–º–∏—á–µ—Å–∫–∞—è —á–∞—à–∞', icon: 'ü•£', category: 'decor', style: 'artisan', color: '#7a5a4a' },
                { id: 'figurine_porcelain', name: '–§–∞—Ä—Ñ–æ—Ä–æ–≤–∞—è —Å—Ç–∞—Ç—É—ç—Ç–∫–∞', icon: 'üë§', category: 'decor', style: 'rococo', color: '#f5f0e0' },
                { id: 'tapestry_wall', name: '–ì–æ–±–µ–ª–µ–Ω –Ω–∞—Å—Ç–µ–Ω–Ω—ã–π', icon: 'üñºÔ∏è', category: 'decor', style: 'medieval', color: '#8b1e3f' },
                { id: 'vase_floor', name: '–ù–∞–ø–æ–ª—å–Ω–∞—è –≤–∞–∑–∞', icon: 'üè∫', category: 'decor', style: 'modern', color: '#2a3a4a' }
            ],
            
            // –†–ê–°–¢–ï–ù–ò–Ø
            plants: [
                { id: 'ficus', name: '–§–∏–∫—É—Å –ë–µ–Ω–¥–∂–∞–º–∏–Ω–∞', icon: 'üåø', category: 'plants', style: 'tropical', color: '#2e8b57' },
                { id: 'palm_areca', name: '–ü–∞–ª—å–º–∞ –ê—Ä–µ–∫–∞', icon: 'üå¥', category: 'plants', style: 'tropical', color: '#228b22' },
                { id: 'cactus_saguaro', name: '–ö–∞–∫—Ç—É—Å –°–∞–≥—É–∞—Ä–æ', icon: 'üåµ', category: 'plants', style: 'desert', color: '#5f9f4f' },
                { id: 'bonsai', name: '–ë–æ–Ω—Å–∞–π', icon: 'üéç', category: 'plants', style: 'japanese', color: '#6b8e23' },
                { id: 'orchid', name: '–û—Ä—Ö–∏–¥–µ—è', icon: 'üå∏', category: 'plants', style: 'exotic', color: '#d87093' },
                { id: 'fern', name: '–ü–∞–ø–æ—Ä–æ—Ç–Ω–∏–∫', icon: 'üåø', category: 'plants', style: 'forest', color: '#3cb371' },
                { id: 'succulent_set', name: '–ù–∞–±–æ—Ä —Å—É–∫–∫—É–ª–µ–Ω—Ç–æ–≤', icon: 'üå±', category: 'plants', style: 'modern', color: '#7ccd7c' },
                { id: 'monstera', name: '–ú–æ–Ω—Å—Ç–µ—Ä–∞', icon: 'üåø', category: 'plants', style: 'tropical', color: '#32cd32' },
                { id: 'bamboo', name: '–ë–∞–º–±—É–∫', icon: 'üéã', category: 'plants', style: 'asian', color: '#9acd32' },
                { id: 'rose_bush', name: '–†–æ–∑–æ–≤—ã–π –∫—É—Å—Ç', icon: 'üåπ', category: 'plants', style: 'romantic', color: '#ff69b4' }
            ],
            
            // –¢–ï–•–ù–ò–ö–ê
            electronics: [
                { id: 'tv_oled', name: '–¢–µ–ª–µ–≤–∏–∑–æ—Ä OLED 65"', icon: 'üì∫', category: 'electronics', style: 'modern', color: '#1a1a1a' },
                { id: 'speaker_floor', name: '–ù–∞–ø–æ–ª—å–Ω–∞—è –∞–∫—É—Å—Ç–∏–∫–∞', icon: 'üîä', category: 'electronics', style: 'audiophile', color: '#3a3a3a' },
                { id: 'laptop', name: '–ù–æ—É—Ç–±—É–∫', icon: 'üíª', category: 'electronics', style: 'modern', color: '#2a2a3a' },
                { id: 'monitor', name: '–ú–æ–Ω–∏—Ç–æ—Ä', icon: 'üñ•Ô∏è', category: 'electronics', style: 'modern', color: '#1a1a2a' },
                { id: 'speaker_bluetooth', name: 'Bluetooth –∫–æ–ª–æ–Ω–∫–∞', icon: 'üîä', category: 'electronics', style: 'portable', color: '#4a4a5a' },
                { id: 'projector', name: '–ü—Ä–æ–µ–∫—Ç–æ—Ä', icon: 'üìΩÔ∏è', category: 'electronics', style: 'home theater', color: '#2a2a2a' },
                { id: 'game_console', name: '–ò–≥—Ä–æ–≤–∞—è –ø—Ä–∏—Å—Ç–∞–≤–∫–∞', icon: 'üéÆ', category: 'electronics', style: 'gaming', color: '#1a2a3a' },
                { id: 'vr_headset', name: 'VR —à–ª–µ–º', icon: 'ü•Ω', category: 'electronics', style: 'futuristic', color: '#ffffff' },
                { id: 'smart_display', name: '–£–º–Ω—ã–π –¥–∏—Å–ø–ª–µ–π', icon: 'üì±', category: 'electronics', style: 'modern', color: '#2a2a2a' },
                { id: 'router', name: 'WiFi —Ä–æ—É—Ç–µ—Ä', icon: 'üì∂', category: 'electronics', style: 'tech', color: '#1a1a1a' }
            ],
            
            // –ö–£–•–ù–Ø
            kitchen: [
                { id: 'refrigerator', name: '–•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫', icon: 'üßä', category: 'kitchen', style: 'modern', color: '#f0f0f0' },
                { id: 'oven', name: '–î—É—Ö–æ–≤–æ–π —à–∫–∞—Ñ', icon: 'üî•', category: 'kitchen', style: 'modern', color: '#3a3a3a' },
                { id: 'microwave', name: '–ú–∏–∫—Ä–æ–≤–æ–ª–Ω–æ–≤–∞—è –ø–µ—á—å', icon: 'üìª', category: 'kitchen', style: 'modern', color: '#d3d3d3' },
                { id: 'dishwasher', name: '–ü–æ—Å—É–¥–æ–º–æ–µ—á–Ω–∞—è –º–∞—à–∏–Ω–∞', icon: 'üßº', category: 'kitchen', style: 'modern', color: '#e0e0e0' },
                { id: 'coffee_machine', name: '–ö–æ—Ñ–µ–º–∞—à–∏–Ω–∞', icon: '‚òï', category: 'kitchen', style: 'modern', color: '#4a4a4a' },
                { id: 'toaster', name: '–¢–æ—Å—Ç–µ—Ä', icon: 'üçû', category: 'kitchen', style: 'retro', color: '#c47e5a' },
                { id: 'kettle', name: '–ß–∞–π–Ω–∏–∫', icon: 'ü´ñ', category: 'kitchen', style: 'modern', color: '#c0c0c0' },
                { id: 'mixer', name: '–ú–∏–∫—Å–µ—Ä', icon: 'ü•Ñ', category: 'kitchen', style: 'modern', color: '#ff69b4' },
                { id: 'blender', name: '–ë–ª–µ–Ω–¥–µ—Ä', icon: 'ü•§', category: 'kitchen', style: 'modern', color: '#2a2a2a' },
                { id: 'kitchen_scale', name: '–ö—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã', icon: '‚öñÔ∏è', category: 'kitchen', style: 'modern', color: '#c0c0c0' }
            ],
            
            // –°–¢–û–õ–´
            tables: [
                { id: 'dining_table', name: '–û–±–µ–¥–µ–Ω–Ω—ã–π —Å—Ç–æ–ª', icon: 'ü™ë', category: 'tables', style: 'classic', color: '#8b5a2b' },
                { id: 'coffee_table', name: '–ñ—É—Ä–Ω–∞–ª—å–Ω—ã–π —Å—Ç–æ–ª–∏–∫', icon: 'ü™ë', category: 'tables', style: 'modern', color: '#5a3a2a' },
                { id: 'desk', name: '–ü–∏—Å—å–º–µ–Ω–Ω—ã–π —Å—Ç–æ–ª', icon: 'üìù', category: 'tables', style: 'office', color: '#4a3a2a' },
                { id: 'console_table', name: '–°—Ç–æ–ª-–∫–æ–Ω—Å–æ–ª—å', icon: 'ü™ë', category: 'tables', style: 'elegant', color: '#c49a6c' },
                { id: 'nightstand', name: '–ü—Ä–∏–∫—Ä–æ–≤–∞—Ç–Ω–∞—è —Ç—É–º–±–∞', icon: 'ü™ë', category: 'tables', style: 'bedroom', color: '#8b5a2b' },
                { id: 'side_table', name: '–ü—Ä–∏—Å—Ç–∞–≤–Ω–æ–π —Å—Ç–æ–ª–∏–∫', icon: 'ü™ë', category: 'tables', style: 'modern', color: '#5a5a5a' },
                { id: 'bar_table', name: '–ë–∞—Ä–Ω—ã–π —Å—Ç–æ–ª', icon: 'üç∑', category: 'tables', style: 'industrial', color: '#3a3a3a' },
                { id: 'computer_desk', name: '–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π —Å—Ç–æ–ª', icon: 'üíª', category: 'tables', style: 'gaming', color: '#1a1a1a' },
                { id: 'folding_table', name: '–°–∫–ª–∞–¥–Ω–æ–π —Å—Ç–æ–ª', icon: 'ü™ë', category: 'tables', style: 'practical', color: '#8b5a2b' },
                { id: 'picnic_table', name: '–°—Ç–æ–ª –¥–ª—è –ø–∏–∫–Ω–∏–∫–∞', icon: 'üß∫', category: 'tables', style: 'outdoor', color: '#8b5a2b' }
            ],
            
            // –•–†–ê–ù–ï–ù–ò–ï
            storage: [
                { id: 'wardrobe', name: '–®–∫–∞—Ñ-–∫—É–ø–µ', icon: 'üö™', category: 'storage', style: 'modern', color: '#8b5a2b' },
                { id: 'bookshelf', name: '–ö–Ω–∏–∂–Ω—ã–π —Å—Ç–µ–ª–ª–∞–∂', icon: 'üìö', category: 'storage', style: 'library', color: '#5a3a2a' },
                { id: 'dresser', name: '–ö–æ–º–æ–¥', icon: 'üóÑÔ∏è', category: 'storage', style: 'classic', color: '#c49a6c' },
                { id: 'cabinet', name: '–¢—É–º–±–∞', icon: 'üóÑÔ∏è', category: 'storage', style: 'modern', color: '#4a4a4a' },
                { id: 'shelf_wall', name: '–ù–∞—Å—Ç–µ–Ω–Ω–∞—è –ø–æ–ª–∫–∞', icon: 'üì¶', category: 'storage', style: 'minimal', color: '#8b5a2b' },
                { id: 'chest', name: '–°—É–Ω–¥—É–∫', icon: 'üß∞', category: 'storage', style: 'vintage', color: '#8b4513' },
                { id: 'basket', name: '–ö–æ—Ä–∑–∏–Ω–∞', icon: 'üß∫', category: 'storage', style: 'rustic', color: '#d2b48c' },
                { id: 'shoe_cabinet', name: '–û–±—É–≤–Ω–∏—Ü–∞', icon: 'üëû', category: 'storage', style: 'modern', color: '#5a5a5a' },
                { id: 'display_cabinet', name: '–í–∏—Ç—Ä–∏–Ω–∞', icon: 'üèõÔ∏è', category: 'storage', style: 'luxury', color: '#d4af37' },
                { id: 'nightstand_drawer', name: '–¢—É–º–±–∞ —Å —è—â–∏–∫–∞–º–∏', icon: 'üóÑÔ∏è', category: 'storage', style: 'bedroom', color: '#8b5a2b' }
            ],
            
            // –í–ê–ù–ù–ê–Ø
            bathroom: [
                { id: 'bathtub', name: '–í–∞–Ω–Ω–∞', icon: 'üõÅ', category: 'bathroom', style: 'luxury', color: '#f0f0f0' },
                { id: 'sink', name: '–†–∞–∫–æ–≤–∏–Ω–∞', icon: 'üö∞', category: 'bathroom', style: 'modern', color: '#f0f0f0' },
                { id: 'toilet', name: '–£–Ω–∏—Ç–∞–∑', icon: 'üöΩ', category: 'bathroom', style: 'modern', color: '#f0f0f0' },
                { id: 'shower', name: '–î—É—à–µ–≤–∞—è –∫–∞–±–∏–Ω–∞', icon: 'üöø', category: 'bathroom', style: 'modern', color: '#c0c0c0' },
                { id: 'bidet', name: '–ë–∏–¥–µ', icon: 'üöΩ', category: 'bathroom', style: 'modern', color: '#f0f0f0' },
                { id: 'bathroom_cabinet', name: '–®–∫–∞—Ñ—á–∏–∫ –¥–ª—è –≤–∞–Ω–Ω–æ–π', icon: 'üóÑÔ∏è', category: 'bathroom', style: 'modern', color: '#ffffff' },
                { id: 'mirror_bathroom', name: '–ó–µ—Ä–∫–∞–ª–æ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π', icon: 'ü™û', category: 'bathroom', style: 'modern', color: '#c0c0c0' },
                { id: 'towel_rack', name: '–ü–æ–ª–æ—Ç–µ–Ω—Ü–µ—Å—É—à–∏—Ç–µ–ª—å', icon: 'üß£', category: 'bathroom', style: 'modern', color: '#c0c0c0' },
                { id: 'soap_dispenser', name: '–î–æ–∑–∞—Ç–æ—Ä –¥–ª—è –º—ã–ª–∞', icon: 'üß¥', category: 'bathroom', style: 'modern', color: '#ffffff' },
                { id: 'toilet_brush', name: '–ï—Ä—à–∏–∫ –¥–ª—è —É–Ω–∏—Ç–∞–∑–∞', icon: 'üßπ', category: 'bathroom', style: 'practical', color: '#2a2a2a' }
            ],
            
            // –¢–ï–ö–°–¢–ò–õ–¨
            textiles: [
                { id: 'carpet_persian', name: '–ü–µ—Ä—Å–∏–¥—Å–∫–∏–π –∫–æ–≤–µ—Ä', icon: 'üß∂', category: 'textiles', style: 'oriental', color: '#8b1e3f' },
                { id: 'curtains', name: '–®—Ç–æ—Ä—ã', icon: 'ü™ü', category: 'textiles', style: 'elegant', color: '#d4b088' },
                { id: 'blanket', name: '–ü–ª–µ–¥', icon: 'üß£', category: 'textiles', style: 'cozy', color: '#8b5a2b' },
                { id: 'pillow_decorative', name: '–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥—É—à–∫–∞', icon: 'üõèÔ∏è', category: 'textiles', style: 'modern', color: '#c47e5a' },
                { id: 'tablecloth', name: '–°–∫–∞—Ç–µ—Ä—Ç—å', icon: 'üßµ', category: 'textiles', style: 'classic', color: '#f0e0d0' },
                { id: 'towel_set', name: '–ù–∞–±–æ—Ä –ø–æ–ª–æ—Ç–µ–Ω–µ—Ü', icon: 'üß£', category: 'textiles', style: 'bath', color: '#87ceeb' },
                { id: 'bedspread', name: '–ü–æ–∫—Ä—ã–≤–∞–ª–æ', icon: 'üõèÔ∏è', category: 'textiles', style: 'bedroom', color: '#dda0dd' },
                { id: 'runner', name: '–î–æ—Ä–æ–∂–∫–∞ –Ω–∞ —Å—Ç–æ–ª', icon: 'üßµ', category: 'textiles', style: 'traditional', color: '#d4b088' },
                { id: 'napkins', name: '–°–∞–ª—Ñ–µ—Ç–∫–∏', icon: 'üßª', category: 'textiles', style: 'dinner', color: '#f0f0f0' },
                { id: 'ottoman_cover', name: '–ß–µ—Ö–æ–ª –¥–ª—è –ø—É—Ñ–∞', icon: 'ü™ë', category: 'textiles', style: 'modern', color: '#c47e5a' }
            ],
            
            // –û–§–ò–°
            office: [
                { id: 'office_chair', name: '–û—Ñ–∏—Å–Ω–æ–µ –∫—Ä–µ—Å–ª–æ', icon: 'üí∫', category: 'office', style: 'ergonomic', color: '#2a3a4a' },
                { id: 'filing_cabinet', name: '–ö–∞—Ä—Ç–æ—Ç–µ—á–Ω—ã–π —à–∫–∞—Ñ', icon: 'üóÑÔ∏è', category: 'office', style: 'practical', color: '#5a5a5a' },
                { id: 'whiteboard', name: '–ë–µ–ª–∞—è –¥–æ—Å–∫–∞', icon: 'üìã', category: 'office', style: 'meeting', color: '#f0f0f0' },
                { id: 'bookshelf_office', name: '–û—Ñ–∏—Å–Ω—ã–π —Å—Ç–µ–ª–ª–∞–∂', icon: 'üìö', category: 'office', style: 'modern', color: '#4a3a2a' },
                { id: 'desk_lamp', name: '–û—Ñ–∏—Å–Ω–∞—è –ª–∞–º–ø–∞', icon: 'üí°', category: 'office', style: 'practical', color: '#3a3a3a' },
                { id: 'paper_tray', name: '–õ–æ—Ç–æ–∫ –¥–ª—è –±—É–º–∞–≥', icon: 'üìÑ', category: 'office', style: 'organization', color: '#2a2a2a' },
                { id: 'pencil_holder', name: '–ü–æ–¥—Å—Ç–∞–≤–∫–∞ –¥–ª—è —Ä—É—á–µ–∫', icon: '‚úèÔ∏è', category: 'office', style: 'desk', color: '#8b5a2b' },
                { id: 'calendar', name: '–ù–∞—Å—Ç–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å', icon: 'üìÖ', category: 'office', style: 'planning', color: '#f0f0f0' },
                { id: 'printer', name: '–ü—Ä–∏–Ω—Ç–µ—Ä', icon: 'üñ®Ô∏è', category: 'office', style: 'tech', color: '#3a3a3a' },
                { id: 'waste_basket', name: '–ö–æ—Ä–∑–∏–Ω–∞ –¥–ª—è –±—É–º–∞–≥', icon: 'üóëÔ∏è', category: 'office', style: 'practical', color: '#2a2a2a' }
            ]
        };

        // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã –≤ –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤
        const allItems = [];
        for (const category in catalogData) {
            allItems.push(...catalogData[category]);
        }

        console.log(`üì¶ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${allItems.length} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö 3D –º–æ–¥–µ–ª–µ–π`);

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        const canvas = document.getElementById('canvas');
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0a12);
        scene.fog = new THREE.FogExp2(0x0a0a12, 0.002);

        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(20, 10, 30);
        camera.lookAt(0, 2, 0);

        const renderer = new THREE.WebGLRenderer({ 
            canvas: canvas, 
            antialias: true,
            powerPreference: "high-performance",
            stencil: false,
            depth: true,
            alpha: false
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        renderer.shadowMap.bias = 0.00005;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.0;
        renderer.outputEncoding = THREE.sRGBEncoding;

        const renderScene = new RenderPass(scene, camera);
        
        const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 0.7, 0.2, 0.7);
        bloomPass.threshold = 0.2;
        bloomPass.strength = 0.6;
        bloomPass.radius = 0.5;

        const filmPass = new FilmPass(0.1, 0.5, 2048, false);
        
        const vignettePass = new ShaderPass({
            uniforms: {
                tDiffuse: { value: null },
                intensity: { value: 0.5 }
            },
            vertexShader: `
                varying vec2 vUv;
                void main() {
                    vUv = uv;
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                }
            `,
            fragmentShader: `
                uniform sampler2D tDiffuse;
                uniform float intensity;
                varying vec2 vUv;
                
                void main() {
                    vec4 color = texture2D(tDiffuse, vUv);
                    float dist = distance(vUv, vec2(0.5, 0.5));
                    float vignette = 1.0 - dist * intensity;
                    gl_FragColor = vec4(color.rgb * vignette, color.a);
                }
            `
        });

        const composer = new EffectComposer(renderer);
        composer.addPass(renderScene);
        composer.addPass(bloomPass);
        composer.addPass(vignettePass);
        filmPass.renderToScreen = true;
        composer.addPass(filmPass);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.04;
        controls.maxPolarAngle = Math.PI / 2.1;
        controls.minDistance = 3;
        controls.maxDistance = 100;
        controls.target.set(0, 2, 0);
        controls.rotateSpeed = 0.6;

        // ==================== –û–°–í–ï–©–ï–ù–ò–ï ====================
        const mainLight = new THREE.DirectionalLight(0xffeedd, 1.0);
        mainLight.position.set(8, 15, 10);
        mainLight.castShadow = true;
        mainLight.shadow.mapSize.width = 4096;
        mainLight.shadow.mapSize.height = 4096;
        mainLight.shadow.camera.near = 1;
        mainLight.shadow.camera.far = 50;
        mainLight.shadow.camera.left = -20;
        mainLight.shadow.camera.right = 20;
        mainLight.shadow.camera.top = 20;
        mainLight.shadow.camera.bottom = -20;
        mainLight.shadow.bias = -0.0001;
        mainLight.shadow.normalBias = 0.02;
        scene.add(mainLight);

        const fillLightWarm = new THREE.PointLight(0xffaa66, 0.5);
        fillLightWarm.position.set(-5, 4, 8);
        scene.add(fillLightWarm);

        const fillLightCool = new THREE.PointLight(0x6688ff, 0.3);
        fillLightCool.position.set(7, 3, -6);
        scene.add(fillLightCool);

        const ambientLight = new THREE.AmbientLight(0x40486c, 0.5);
        scene.add(ambientLight);

        // ==================== –û–ö–†–£–ñ–ï–ù–ò–ï ====================
        const groundGeo = new THREE.CircleGeometry(200, 128);
        const groundMat = new THREE.MeshStandardMaterial({
            color: 0x0a0812,
            roughness: 0.8,
            metalness: 0.05,
            emissive: 0x000000
        });
        const ground = new THREE.Mesh(groundGeo, groundMat);
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = 0;
        ground.receiveShadow = true;
        scene.add(ground);

        const gridHelper = new THREE.GridHelper(200, 100, 0xd4b088, 0x2a2a3a);
        gridHelper.position.y = 0.01;
        scene.add(gridHelper);

        // –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã
        const particleCount = 1000;
        const particlesGeo = new THREE.BufferGeometry();
        const particlesPos = new Float32Array(particleCount * 3);
        for (let i = 0; i < particleCount * 3; i += 3) {
            particlesPos[i] = (Math.random() - 0.5) * 200;
            particlesPos[i+1] = (Math.random() * 50);
            particlesPos[i+2] = (Math.random() - 0.5) * 200;
        }
        particlesGeo.setAttribute('position', new THREE.BufferAttribute(particlesPos, 3));
        const particlesMat = new THREE.PointsMaterial({
            color: 0xd4b088,
            size: 0.05,
            transparent: true,
            opacity: 0.15,
            blending: THREE.AdditiveBlending
        });
        const particles = new THREE.Points(particlesGeo, particlesMat);
        scene.add(particles);

        // ==================== –ú–ê–¢–ï–†–ò–ê–õ–´ ====================
        function createPremiumMaterial(type, color) {
            const colorHex = parseInt(color.replace('#', '0x'), 16);
            
            const materials = {
                wood: new THREE.MeshStandardMaterial({ color: colorHex, roughness: 0.4, metalness: 0.05 }),
                walnut: new THREE.MeshStandardMaterial({ color: 0x4a2c1a, roughness: 0.35, metalness: 0.02 }),
                oak_light: new THREE.MeshStandardMaterial({ color: 0xc49a6c, roughness: 0.45, metalness: 0.01 }),
                mahogany: new THREE.MeshStandardMaterial({ color: 0x6b2e1a, roughness: 0.3, metalness: 0.02 }),
                metal_brushed: new THREE.MeshStandardMaterial({ color: 0x8899aa, roughness: 0.25, metalness: 0.9 }),
                metal_polished: new THREE.MeshStandardMaterial({ color: 0xccddee, roughness: 0.1, metalness: 1.0 }),
                copper: new THREE.MeshStandardMaterial({ color: 0xb87333, roughness: 0.2, metalness: 0.95 }),
                brass: new THREE.MeshStandardMaterial({ color: 0xf1c40f, roughness: 0.15, metalness: 0.98 }),
                fabric_velvet: new THREE.MeshStandardMaterial({ color: colorHex, roughness: 0.8, metalness: 0.0 }),
                fabric_linen: new THREE.MeshStandardMaterial({ color: colorHex, roughness: 0.9, metalness: 0.0 }),
                leather: new THREE.MeshStandardMaterial({ color: colorHex, roughness: 0.6, metalness: 0.1 }),
                glass_clear: new THREE.MeshStandardMaterial({ color: colorHex, roughness: 0.05, metalness: 0.0, transparent: true, opacity: 0.85 }),
                glass_frosted: new THREE.MeshStandardMaterial({ color: colorHex, roughness: 0.3, metalness: 0.0, transparent: true, opacity: 0.7 }),
                marble: new THREE.MeshStandardMaterial({ color: 0xf5f5f5, roughness: 0.2, metalness: 0.05 }),
                granite: new THREE.MeshStandardMaterial({ color: 0x5a5a6a, roughness: 0.5, metalness: 0.1 }),
                ceramic: new THREE.MeshStandardMaterial({ color: colorHex, roughness: 0.4, metalness: 0.0 }),
                plastic: new THREE.MeshStandardMaterial({ color: colorHex, roughness: 0.3, metalness: 0.0 })
            };
            
            return materials[type] || materials.wood;
        }

        // ==================== –†–ï–ê–õ–¨–ù–´–ï 3D –ú–û–î–ï–õ–ò ====================
        
        // –ö—Ä–µ—Å–ª–æ –ß–µ—Å—Ç–µ—Ä—Ñ–∏–ª–¥
        function createChesterfield(color, materialType) {
            const group = new THREE.Group();
            const leatherMat = createPremiumMaterial('leather', color);
            const woodMat = createPremiumMaterial('walnut', '#5a3a2a');
            const metalMat = createPremiumMaterial('metal_brushed', '#aaa');
            
            // –û—Å–Ω–æ–≤–∞–Ω–∏–µ
            const base = new THREE.Mesh(new THREE.BoxGeometry(1.2, 0.2, 1.1), woodMat);
            base.position.y = 0.1;
            base.castShadow = true;
            base.receiveShadow = true;
            group.add(base);
            
            // –°–∏–¥–µ–Ω—å–µ
            const seat = new THREE.Mesh(new THREE.BoxGeometry(1.1, 0.3, 1.0), leatherMat);
            seat.position.y = 0.35;
            seat.castShadow = true;
            seat.receiveShadow = true;
            group.add(seat);
            
            // –°–ø–∏–Ω–∫–∞
            const back = new THREE.Mesh(new THREE.BoxGeometry(1.1, 1.0, 0.3), leatherMat);
            back.position.set(0, 0.9, -0.4);
            back.castShadow = true;
            back.receiveShadow = true;
            group.add(back);
            
            // –ö–∞–ø–∏—Ç–æ–Ω–µ (–ø—É–≥–æ–≤–∏—Ü—ã)
            for (let i = -0.4; i <= 0.4; i+=0.4) {
                for (let j = 0.6; j <= 1.1; j+=0.25) {
                    const button = new THREE.Mesh(new THREE.SphereGeometry(0.06, 8), metalMat);
                    button.position.set(i, j, -0.25);
                    button.castShadow = true;
                    group.add(button);
                }
            }
            
            // –ü–æ–¥–ª–æ–∫–æ—Ç–Ω–∏–∫–∏
            const armLeft = new THREE.Mesh(new THREE.BoxGeometry(0.2, 0.5, 1.0), leatherMat);
            armLeft.position.set(-0.7, 0.6, 0);
            armLeft.castShadow = true;
            armLeft.receiveShadow = true;
            group.add(armLeft);
            
            const armRight = new THREE.Mesh(new THREE.BoxGeometry(0.2, 0.5, 1.0), leatherMat);
            armRight.position.set(0.7, 0.6, 0);
            armRight.castShadow = true;
            armRight.receiveShadow = true;
            group.add(armRight);
            
            // –ù–æ–∂–∫–∏
            const legGeo = new THREE.CylinderGeometry(0.08, 0.1, 0.2, 6);
            for (let x = -0.4; x <= 0.4; x+=0.8) {
                for (let z = -0.4; z <= 0.4; z+=0.8) {
                    const leg = new THREE.Mesh(legGeo, woodMat);
                    leg.position.set(x, 0.1, z);
                    leg.castShadow = true;
                    leg.receiveShadow = true;
                    group.add(leg);
                }
            }
            
            return group;
        }

        // –î–∏–≤–∞–Ω –±–∞—Ä—Ö–∞—Ç–Ω—ã–π
        function createVelvetSofa(color, materialType) {
            const group = new THREE.Group();
            const fabricMat = createPremiumMaterial('fabric_velvet', color);
            const woodMat = createPremiumMaterial('walnut', '#5a3a2a');
            
            // –û—Å–Ω–æ–≤–∞
            const base = new THREE.Mesh(new THREE.BoxGeometry(2.2, 0.4, 1.0), woodMat);
            base.position.y = 0.2;
            base.castShadow = true;
            base.receiveShadow = true;
            group.add(base);
            
            // –°–∏–¥–µ–Ω—å–µ
            const seat = new THREE.Mesh(new THREE.BoxGeometry(2.1, 0.4, 0.9), fabricMat);
            seat.position.y = 0.5;
            seat.castShadow = true;
            seat.receiveShadow = true;
            group.add(seat);
            
            // –ü–æ–¥—É—à–∫–∏ —Å–∏–¥–µ–Ω—å—è
            for (let i = -0.7; i <= 0.7; i+=0.7) {
                const cushion = new THREE.Mesh(new THREE.BoxGeometry(0.6, 0.2, 0.8), fabricMat);
                cushion.position.set(i, 0.7, 0);
                cushion.castShadow = true;
                cushion.receiveShadow = true;
                group.add(cushion);
            }
            
            // –°–ø–∏–Ω–∫–∞
            const back = new THREE.Mesh(new THREE.BoxGeometry(2.2, 1.0, 0.3), fabricMat);
            back.position.set(0, 1.0, -0.4);
            back.castShadow = true;
            back.receiveShadow = true;
            group.add(back);
            
            // –ü–æ–¥—É—à–∫–∏ —Å–ø–∏–Ω–∫–∏
            for (let i = -0.7; i <= 0.7; i+=0.7) {
                const backCushion = new THREE.Mesh(new THREE.BoxGeometry(0.6, 0.7, 0.2), fabricMat);
                backCushion.position.set(i, 1.1, -0.3);
                backCushion.castShadow = true;
                backCushion.receiveShadow = true;
                group.add(backCushion);
            }
            
            // –ù–æ–∂–∫–∏
            const legGeo = new THREE.CylinderGeometry(0.1, 0.12, 0.2, 6);
            for (let x = -1.0; x <= 1.0; x+=2.0) {
                for (let z = -0.4; z <= 0.4; z+=0.8) {
                    const leg = new THREE.Mesh(legGeo, woodMat);
                    leg.position.set(x, 0.1, z);
                    leg.castShadow = true;
                    leg.receiveShadow = true;
                    group.add(leg);
                }
            }
            
            return group;
        }

        // –ö—Ä–µ—Å–ª–æ Eames
        function createEamesChair(color, materialType) {
            const group = new THREE.Group();
            const plasticMat = createPremiumMaterial('plastic', color);
            const woodMat = createPremiumMaterial('walnut', '#5a3a2a');
            
            // –û—Å–Ω–æ–≤–∞–Ω–∏–µ-–∫–∞—á–∞–ª–∫–∞
            const base = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.5, 0.1, 16), woodMat);
            base.scale.set(1.5, 1, 1.2);
            base.rotation.x = 0.1;
            base.position.y = 0.05;
            base.castShadow = true;
            base.receiveShadow = true;
            group.add(base);
            
            // –°–∏–¥–µ–Ω—å–µ
            const seat = new THREE.Mesh(new THREE.SphereGeometry(0.5, 16), plasticMat);
            seat.scale.set(1.3, 0.4, 1.1);
            seat.position.y = 0.4;
            seat.castShadow = true;
            seat.receiveShadow = true;
            group.add(seat);
            
            // –°–ø–∏–Ω–∫–∞
            const back = new THREE.Mesh(new THREE.SphereGeometry(0.5, 16), plasticMat);
            back.scale.set(1.3, 0.8, 0.3);
            back.position.set(0, 0.8, -0.4);
            back.castShadow = true;
            back.receiveShadow = true;
            group.add(back);
            
            // –ü–æ–¥–ª–æ–∫–æ—Ç–Ω–∏–∫–∏
            const armGeo = new THREE.CylinderGeometry(0.1, 0.1, 0.5, 6);
            const armLeft = new THREE.Mesh(armGeo, woodMat);
            armLeft.position.set(-0.7, 0.6, 0);
            armLeft.rotation.z = 0.2;
            armLeft.castShadow = true;
            armLeft.receiveShadow = true;
            group.add(armLeft);
            
            const armRight = new THREE.Mesh(armGeo, woodMat);
            armRight.position.set(0.7, 0.6, 0);
            armRight.rotation.z = -0.2;
            armRight.castShadow = true;
            armRight.receiveShadow = true;
            group.add(armRight);
            
            return group;
        }

        // –•—Ä—É—Å—Ç–∞–ª—å–Ω–∞—è –ª—é—Å—Ç—Ä–∞
        function createCrystalChandelier(color, materialType) {
            const group = new THREE.Group();
            const metalMat = createPremiumMaterial('brass', '#d4af37');
            const glassMat = createPremiumMaterial('glass_clear', '#ffffff');
            
            // –ö—Ä–µ–ø–ª–µ–Ω–∏–µ
            const mount = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.3, 0.2, 6), metalMat);
            mount.position.y = 0.1;
            mount.castShadow = true;
            mount.receiveShadow = true;
            group.add(mount);
            
            // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å
            const center = new THREE.Mesh(new THREE.SphereGeometry(0.4, 8), metalMat);
            center.position.y = 0;
            center.castShadow = true;
            center.receiveShadow = true;
            group.add(center);
            
            // –ö—Ä–∏—Å—Ç–∞–ª–ª—ã
            for (let i = 0; i < 12; i++) {
                const angle = (i / 12) * Math.PI * 2;
                const crystal = new THREE.Mesh(new THREE.ConeGeometry(0.15, 0.8, 6), glassMat);
                crystal.position.set(Math.cos(angle) * 0.8, -0.4, Math.sin(angle) * 0.8);
                crystal.castShadow = true;
                crystal.receiveShadow = true;
                group.add(crystal);
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–µ—Ç
                const light = new THREE.PointLight(0xffeedd, 0.5, 5);
                light.position.set(Math.cos(angle) * 0.8, 0, Math.sin(angle) * 0.8);
                group.add(light);
            }
            
            return group;
        }

        // –¢–æ—Ä—à–µ—Ä Arc
        function createArcFloorLamp(color, materialType) {
            const group = new THREE.Group();
            const metalMat = createPremiumMaterial('metal_polished', '#aaaaaa');
            const lampMat = createPremiumMaterial('plastic', '#ffffff');
            
            // –û—Å–Ω–æ–≤–∞–Ω–∏–µ
            const base = new THREE.Mesh(new THREE.CylinderGeometry(0.4, 0.5, 0.1, 8), metalMat);
            base.position.y = 0.05;
            base.castShadow = true;
            base.receiveShadow = true;
            group.add(base);
            
            // –°—Ç–æ–π–∫–∞
            const pole = new THREE.Mesh(new THREE.CylinderGeometry(0.08, 0.1, 2.0, 8), metalMat);
            pole.position.y = 1.05;
            pole.castShadow = true;
            pole.receiveShadow = true;
            group.add(pole);
            
            // –î—É–≥–∞
            const arc = new THREE.Mesh(new THREE.TorusGeometry(0.8, 0.05, 8, 32), metalMat);
            arc.rotation.x = Math.PI / 2;
            arc.rotation.z = 0.3;
            arc.position.set(0.5, 1.8, 0);
            arc.castShadow = true;
            arc.receiveShadow = true;
            group.add(arc);
            
            // –ü–ª–∞—Ñ–æ–Ω
            const shade = new THREE.Mesh(new THREE.ConeGeometry(0.4, 0.5, 8), lampMat);
            shade.position.set(1.2, 1.6, 0);
            shade.rotation.z = -0.3;
            shade.castShadow = true;
            shade.receiveShadow = true;
            group.add(shade);
            
            // –°–≤–µ—Ç
            const light = new THREE.PointLight(0xffeedd, 1.0, 6);
            light.position.set(1.2, 1.5, 0);
            group.add(light);
            
            return group;
        }

        // –í–∞–∑–∞ —Ñ–∞—Ä—Ñ–æ—Ä–æ–≤–∞—è
        function createPorcelainVase(color, materialType) {
            const group = new THREE.Group();
            const ceramicMat = createPremiumMaterial('ceramic', color);
            
            // –û—Å–Ω–æ–≤–∞–Ω–∏–µ
            const base = new THREE.Mesh(new THREE.CylinderGeometry(0.4, 0.5, 0.2, 8), ceramicMat);
            base.position.y = 0.1;
            base.castShadow = true;
            base.receiveShadow = true;
            group.add(base);
            
            // –¢–µ–ª–æ –≤–∞–∑—ã
            const body = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.4, 0.8, 8), ceramicMat);
            body.position.y = 0.6;
            body.castShadow = true;
            body.receiveShadow = true;
            group.add(body);
            
            // –ì–æ—Ä–ª—ã—à–∫–æ
            const neck = new THREE.Mesh(new THREE.CylinderGeometry(0.3, 0.35, 0.3, 8), ceramicMat);
            neck.position.y = 1.15;
            neck.castShadow = true;
            neck.receiveShadow = true;
            group.add(neck);
            
            // –ì–æ—Ä–ª—ã—à–∫–æ –≤–µ—Ä—Ö
            const top = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.25, 0.2, 8), ceramicMat);
            top.position.y = 1.4;
            top.castShadow = true;
            top.receiveShadow = true;
            group.add(top);
            
            return group;
        }

        // –§–∏–∫—É—Å
        function createFicus(color, materialType) {
            const group = new THREE.Group();
            const potMat = createPremiumMaterial('ceramic', '#8b5a2b');
            const leafMat = createPremiumMaterial('fabric_velvet', '#2e8b57');
            const woodMat = createPremiumMaterial('wood', '#8b5a2b');
            
            // –ì–æ—Ä—à–æ–∫
            const potBase = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.4, 0.3, 8), potMat);
            potBase.position.y = 0.15;
            potBase.castShadow = true;
            potBase.receiveShadow = true;
            group.add(potBase);
            
            const potTop = new THREE.Mesh(new THREE.CylinderGeometry(0.45, 0.5, 0.2, 8), potMat);
            potTop.position.y = 0.4;
            potTop.castShadow = true;
            potTop.receiveShadow = true;
            group.add(potTop);
            
            // –ó–µ–º–ª—è
            const soil = new THREE.Mesh(new THREE.CylinderGeometry(0.4, 0.4, 0.1, 6), woodMat);
            soil.position.y = 0.55;
            soil.castShadow = true;
            soil.receiveShadow = true;
            group.add(soil);
            
            // –°—Ç–≤–æ–ª
            const trunk = new THREE.Mesh(new THREE.CylinderGeometry(0.1, 0.15, 1.0, 6), woodMat);
            trunk.position.y = 1.1;
            trunk.castShadow = true;
            trunk.receiveShadow = true;
            group.add(trunk);
            
            // –õ–∏—Å—Ç—å—è
            for (let i = 0; i < 8; i++) {
                const angle = (i / 8) * Math.PI * 2;
                const leafGroup = new THREE.Group();
                
                for (let j = 0; j < 4; j++) {
                    const leaf = new THREE.Mesh(new THREE.ConeGeometry(0.1, 0.5, 5), leafMat);
                    leaf.position.set(0.3 + j*0.1, 0, 0);
                    leaf.rotation.z = -0.2;
                    leaf.castShadow = true;
                    leaf.receiveShadow = true;
                    leafGroup.add(leaf);
                }
                
                leafGroup.position.set(Math.cos(angle) * 0.5, 1.4, Math.sin(angle) * 0.5);
                leafGroup.rotation.y = angle;
                leafGroup.rotation.z = 0.2;
                group.add(leafGroup);
            }
            
            return group;
        }

        // –®–µ–∑–ª–æ–Ω–≥
        function createChaiseLongue(color, materialType) {
            const group = new THREE.Group();
            const fabricMat = createPremiumMaterial('fabric_velvet', color);
            const metalMat = createPremiumMaterial('metal_brushed', '#cccccc');
            
            // –ö–∞—Ä–∫–∞—Å
            const frame = new THREE.Mesh(new THREE.BoxGeometry(2.0, 0.1, 0.8), metalMat);
            frame.position.y = 0.2;
            frame.castShadow = true;
            frame.receiveShadow = true;
            group.add(frame);
            
            // –°–∏–¥–µ–Ω—å–µ
            const seat = new THREE.Mesh(new THREE.BoxGeometry(1.2, 0.3, 0.7), fabricMat);
            seat.position.set(-0.3, 0.45, 0);
            seat.castShadow = true;
            seat.receiveShadow = true;
            group.add(seat);
            
            // –°–ø–∏–Ω–∫–∞
            const back = new THREE.Mesh(new THREE.BoxGeometry(0.8, 0.8, 0.7), fabricMat);
            back.position.set(0.7, 0.7, 0);
            back.rotation.z = -0.2;
            back.castShadow = true;
            back.receiveShadow = true;
            group.add(back);
            
            // –ù–æ–∂–∫–∏
            const legGeo = new THREE.CylinderGeometry(0.08, 0.1, 0.2, 6);
            for (let x = -0.8; x <= 0.8; x+=1.6) {
                for (let z = -0.3; z <= 0.3; z+=0.6) {
                    const leg = new THREE.Mesh(legGeo, metalMat);
                    leg.position.set(x, 0.1, z);
                    leg.castShadow = true;
                    leg.receiveShadow = true;
                    group.add(leg);
                }
            }
            
            return group;
        }

        // –§–∞–±—Ä–∏–∫–∞ –º–æ–¥–µ–ª–µ–π
        function createModelById(item, color, materialType) {
            switch(item.id) {
                case 'armchair_chesterfield':
                    return createChesterfield(color, materialType);
                case 'sofa_velvet':
                    return createVelvetSofa(color, materialType);
                case 'chair_eames':
                    return createEamesChair(color, materialType);
                case 'chaise_longue':
                    return createChaiseLongue(color, materialType);
                case 'chandelier_crystal':
                    return createCrystalChandelier(color, materialType);
                case 'floor_lamp_arc':
                    return createArcFloorLamp(color, materialType);
                case 'vase_porcelain':
                    return createPorcelainVase(color, materialType);
                case 'ficus':
                    return createFicus(color, materialType);
                default:
                    // –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
                    const group = new THREE.Group();
                    const mat = createPremiumMaterial(materialType, color);
                    
                    // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é, –Ω–æ –∫—Ä–∞—Å–∏–≤—É—é —Ñ–æ—Ä–º—É
                    if (item.category === 'tables' || item.category === 'storage') {
                        const mesh = new THREE.Mesh(new THREE.BoxGeometry(1, 0.8, 0.6), mat);
                        mesh.castShadow = true;
                        mesh.receiveShadow = true;
                        group.add(mesh);
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–∂–∫–∏
                        const legGeo = new THREE.CylinderGeometry(0.1, 0.12, 0.2, 6);
                        const legMat = createPremiumMaterial('wood', '#8b5a2b');
                        for (let x = -0.4; x <= 0.4; x+=0.8) {
                            for (let z = -0.25; z <= 0.25; z+=0.5) {
                                const leg = new THREE.Mesh(legGeo, legMat);
                                leg.position.set(x, -0.3, z);
                                leg.castShadow = true;
                                leg.receiveShadow = true;
                                group.add(leg);
                            }
                        }
                    } else if (item.category === 'lighting') {
                        const mesh = new THREE.Mesh(new THREE.ConeGeometry(0.5, 1, 8), mat);
                        mesh.castShadow = true;
                        mesh.receiveShadow = true;
                        group.add(mesh);
                        
                        const light = new THREE.PointLight(0xffeedd, 0.8, 5);
                        light.position.y = 0.5;
                        group.add(light);
                    } else {
                        const mesh = new THREE.Mesh(new THREE.BoxGeometry(0.8, 0.8, 0.8), mat);
                        mesh.castShadow = true;
                        mesh.receiveShadow = true;
                        group.add(mesh);
                    }
                    
                    return group;
            }
        }

        // ==================== UI ====================
        function loadCatalog() {
            const grid = document.getElementById('items-grid');
            const categoriesContainer = document.getElementById('categories-container');
            
            // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            const categories = ['all', ...Object.keys(catalogData)];
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = 'category-btn' + (cat === 'all' ? ' active' : '');
                btn.dataset.category = cat;
                
                // –†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
                const catNames = {
                    'all': '–í–°–Å',
                    'seating': '–ú–ï–ë–ï–õ–¨',
                    'lighting': '–°–í–ï–¢',
                    'decor': '–î–ï–ö–û–†',
                    'plants': '–†–ê–°–¢–ï–ù–ò–Ø',
                    'electronics': '–¢–ï–•–ù–ò–ö–ê',
                    'kitchen': '–ö–£–•–ù–Ø',
                    'tables': '–°–¢–û–õ–´',
                    'storage': '–•–†–ê–ù–ï–ù–ò–ï',
                    'bathroom': '–í–ê–ù–ù–ê–Ø',
                    'textiles': '–¢–ï–ö–°–¢–ò–õ–¨',
                    'office': '–û–§–ò–°'
                };
                
                btn.textContent = catNames[cat] || cat.toUpperCase();
                
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    const category = btn.dataset.category;
                    document.querySelectorAll('.item-card').forEach(item => {
                        if (category === 'all') {
                            item.style.display = 'flex';
                        } else {
                            item.style.display = item.dataset.category === category ? 'flex' : 'none';
                        }
                    });
                });
                
                categoriesContainer.appendChild(btn);
            });
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã
            allItems.forEach(item => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.dataset.id = item.id;
                card.dataset.category = item.category;
                card.innerHTML = `
                    <div class="item-icon">${item.icon}</div>
                    <div class="item-name">${item.name}</div>
                `;
                card.addEventListener('click', (e) => {
                    e.stopPropagation();
                    document.querySelectorAll('.item-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    selectedItem = item;
                    document.getElementById('item-color').value = item.color;
                });
                grid.appendChild(card);
            });
            
            document.getElementById('item-count').textContent = allItems.length;
            document.getElementById('model-count').textContent = allItems.length;
        }

        // –ü–æ–∏—Å–∫
        document.getElementById('search-input').addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            document.querySelectorAll('.item-card').forEach(item => {
                const name = item.querySelector('.item-name').textContent.toLowerCase();
                item.style.display = name.includes(search) ? 'flex' : 'none';
            });
        });

        // –†–µ–∂–∏–º—ã
        document.getElementById('mode-place').addEventListener('click', (e) => {
            e.stopPropagation();
            currentMode = 'place';
            document.getElementById('mode-place').classList.add('active');
            document.getElementById('mode-build').classList.remove('active');
            document.getElementById('build-controls').style.display = 'none';
            document.getElementById('place-controls').style.display = 'block';
            
            if (tempWall) scene.remove(tempWall);
            isBuilding = false;
        });

        document.getElementById('mode-build').addEventListener('click', (e) => {
            e.stopPropagation();
            currentMode = 'build';
            document.getElementById('mode-build').classList.add('active');
            document.getElementById('mode-place').classList.remove('active');
            document.getElementById('build-controls').style.display = 'block';
            document.getElementById('place-controls').style.display = 'none';
        });

        // –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Å—Ç–µ–Ω—É
        document.getElementById('build-wall').addEventListener('click', (e) => {
            e.stopPropagation();
            
            const dir = new THREE.Vector3();
            camera.getWorldDirection(dir);
            dir.y = 0;
            dir.normalize();
            
            const pos = camera.position.clone().add(dir.multiplyScalar(6));
            pos.y = 0;
            
            const length = parseFloat(document.getElementById('wall-length').value);
            const height = parseFloat(document.getElementById('wall-height').value);
            const thickness = parseFloat(document.getElementById('wall-thickness').value);
            const color = document.getElementById('wall-color').value;
            
            const wallMat = new THREE.MeshStandardMaterial({ color: color, roughness: 0.7, metalness: 0.1 });
            const wall = new THREE.Mesh(new THREE.BoxGeometry(thickness, height, length), wallMat);
            wall.position.copy(pos);
            wall.position.y = height / 2;
            wall.castShadow = true;
            wall.receiveShadow = true;
            
            scene.add(wall);
            placedItems.push(wall);
            history.push({ type: 'add', item: wall });
            document.getElementById('total-items').textContent = placedItems.length;
        });

        // –ö–∞—á–µ—Å—Ç–≤–æ —Ç–µ–Ω–µ–π
        document.getElementById('shadow-quality').addEventListener('change', (e) => {
            const quality = e.target.value;
            switch(quality) {
                case 'off':
                    renderer.shadowMap.enabled = false;
                    break;
                case 'low':
                    renderer.shadowMap.enabled = true;
                    mainLight.shadow.mapSize.width = 1024;
                    mainLight.shadow.mapSize.height = 1024;
                    break;
                case 'medium':
                    renderer.shadowMap.enabled = true;
                    mainLight.shadow.mapSize.width = 2048;
                    mainLight.shadow.mapSize.height = 2048;
                    break;
                case 'high':
                    renderer.shadowMap.enabled = true;
                    mainLight.shadow.mapSize.width = 4096;
                    mainLight.shadow.mapSize.height = 4096;
                    break;
                case 'ultra':
                    renderer.shadowMap.enabled = true;
                    mainLight.shadow.mapSize.width = 8192;
                    mainLight.shadow.mapSize.height = 8192;
                    break;
            }
        });

        // –û—Å–≤–µ—â–µ–Ω–∏–µ
        document.getElementById('light-intensity').addEventListener('input', (e) => {
            mainLight.intensity = parseFloat(e.target.value);
        });

        document.getElementById('light-temperature').addEventListener('input', (e) => {
            const temp = parseFloat(e.target.value);
            const r = temp <= 6600 ? 255 : (329.698727446 * Math.pow(temp / 100 - 60, -0.1332047592));
            const g = temp <= 6600 ? (99.4708025861 * Math.log(temp / 100) - 161.1195681661) : 288.1221695283 * Math.pow(temp / 100 - 60, -0.0755148492);
            const b = temp >= 6600 ? 255 : (138.5177312231 * Math.log(temp / 100 - 10) + 305.0447927307);
            
            mainLight.color.setRGB(
                Math.min(255, Math.max(0, r)) / 255,
                Math.min(255, Math.max(0, g)) / 255,
                Math.min(255, Math.max(0, b)) / 255
            );
        });

        // –û—Ç–º–µ–Ω–∞
        document.getElementById('undo-btn').addEventListener('click', () => {
            if (history.length > 0) {
                const last = history.pop();
                if (last.type === 'add') {
                    scene.remove(last.item);
                    const index = placedItems.indexOf(last.item);
                    if (index > -1) placedItems.splice(index, 1);
                }
            }
            document.getElementById('total-items').textContent = placedItems.length;
        });

        // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
        document.getElementById('clear-btn').addEventListener('click', () => {
            placedItems.forEach(item => scene.remove(item));
            placedItems = [];
            history = [];
            document.getElementById('total-items').textContent = '0';
        });

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ
        let selectedItem = null;
        let placedItems = [];
        let currentMode = 'place';
        let lastPlacedMesh = null;
        let history = [];
        
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);
        const intersectionPoint = new THREE.Vector3();

        let isBuilding = false;
        let startPoint = null;
        let tempWall = null;

        // –†–∞–∑–º–µ—â–µ–Ω–∏–µ
        renderer.domElement.addEventListener('click', (event) => {
            if (event.target.closest('.imperial')) return;
            if (currentMode !== 'place' || !selectedItem) return;
            
            mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1;
            mouse.y = -(event.clientY / renderer.domElement.clientHeight) * 2 + 1;
            
            raycaster.setFromCamera(mouse, camera);
            
            if (raycaster.ray.intersectPlane(plane, intersectionPoint)) {
                const color = document.getElementById('item-color').value;
                const scale = parseFloat(document.getElementById('item-scale').value);
                const rotate = parseFloat(document.getElementById('item-rotate').value);
                const heightOffset = parseFloat(document.getElementById('item-height').value);
                const materialType = document.getElementById('material-type').value;
                
                const model = createModelById(selectedItem, color, materialType);
                model.position.copy(intersectionPoint);
                model.position.y = heightOffset;
                model.scale.set(scale, scale, scale);
                model.rotation.y = (rotate * Math.PI) / 180;
                model.castShadow = true;
                model.receiveShadow = true;
                
                scene.add(model);
                placedItems.push(model);
                lastPlacedMesh = model;
                history.push({ type: 'add', item: model });
                
                document.getElementById('total-items').textContent = placedItems.length;
            }
        });

        // –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ —Å—Ç–µ–Ω
        renderer.domElement.addEventListener('mousedown', (event) => {
            if (event.target.closest('.imperial')) return;
            if (currentMode !== 'build' || event.button !== 0) return;
            
            mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1;
            mouse.y = -(event.clientY / renderer.domElement.clientHeight) * 2 + 1;
            
            raycaster.setFromCamera(mouse, camera);
            
            if (raycaster.ray.intersectPlane(plane, intersectionPoint)) {
                isBuilding = true;
                startPoint = intersectionPoint.clone();
                startPoint.y = 0;
                
                const thickness = parseFloat(document.getElementById('wall-thickness').value);
                tempWall = new THREE.Mesh(
                    new THREE.BoxGeometry(thickness, 3, 0.1),
                    new THREE.MeshStandardMaterial({ color: 0xd4b088, transparent: true, opacity: 0.6, emissive: 0x332211 })
                );
                tempWall.castShadow = true;
                tempWall.receiveShadow = true;
                scene.add(tempWall);
            }
        });

        renderer.domElement.addEventListener('mousemove', (event) => {
            if (event.target.closest('.imperial')) return;
            
            mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1;
            mouse.y = -(event.clientY / renderer.domElement.clientHeight) * 2 + 1;
            
            raycaster.setFromCamera(mouse, camera);
            
            if (raycaster.ray.intersectPlane(plane, intersectionPoint)) {
                if (currentMode === 'build' && isBuilding && tempWall) {
                    const end = intersectionPoint.clone();
                    end.y = 0;
                    
                    const delta = new THREE.Vector3().subVectors(end, startPoint);
                    const length = Math.sqrt(delta.x*delta.x + delta.z*delta.z);
                    const angle = Math.atan2(delta.x, delta.z);
                    
                    const thickness = parseFloat(document.getElementById('wall-thickness').value);
                    const height = parseFloat(document.getElementById('wall-height').value);
                    
                    tempWall.position.x = startPoint.x + delta.x/2;
                    tempWall.position.z = startPoint.z + delta.z/2;
                    tempWall.position.y = height/2;
                    tempWall.scale.set(1, height/3, length);
                    tempWall.rotation.y = angle;
                }
            }
        });

        renderer.domElement.addEventListener('mouseup', (event) => {
            if (event.target.closest('.imperial')) return;
            
            if (currentMode === 'build' && isBuilding && tempWall) {
                const height = parseFloat(document.getElementById('wall-height').value);
                const thickness = parseFloat(document.getElementById('wall-thickness').value);
                const color = document.getElementById('wall-color').value;
                
                const wallMat = new THREE.MeshStandardMaterial({ color: color, roughness: 0.7, metalness: 0.1 });
                const wall = new THREE.Mesh(new THREE.BoxGeometry(thickness, height, tempWall.scale.z), wallMat);
                wall.position.copy(tempWall.position);
                wall.position.y = height/2;
                wall.rotation.copy(tempWall.rotation);
                wall.castShadow = true;
                wall.receiveShadow = true;
                
                scene.add(wall);
                placedItems.push(wall);
                history.push({ type: 'add', item: wall });
                document.getElementById('total-items').textContent = placedItems.length;
                
                scene.remove(tempWall);
                tempWall = null;
                isBuilding = false;
            }
        });

        // FPS
        let lastTime = performance.now();
        let frames = 0;
        
        function updateFPS() {
            frames++;
            const now = performance.now();
            const delta = now - lastTime;
            
            if (delta >= 1000) {
                document.getElementById('fps-counter').textContent = Math.round((frames * 1000) / delta);
                frames = 0;
                lastTime = now;
            }
        }

        // –ü–æ–ª–∏–≥–æ–Ω—ã (–ø—Ä–∏–º–µ—Ä–Ω–æ)
        function updatePolyCount() {
            // –ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å ~500-1000 –ø–æ–ª–∏–≥–æ–Ω–æ–≤
            const avgPolys = 750;
            const totalPolys = placedItems.length * avgPolys;
            document.getElementById('poly-count').textContent = (totalPolys / 1000000).toFixed(1);
        }

        function animate() {
            requestAnimationFrame(animate);
            
            particles.rotation.y += 0.00002;
            controls.update();
            composer.render();
            updateFPS();
            updatePolyCount();
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });

        if (window.Telegram?.WebApp) {
            window.Telegram.WebApp.expand();
            window.Telegram.WebApp.ready();
        }

        loadCatalog();
        animate();
        
        console.log('üèõÔ∏è –ò–ú–ü–ï–†–ò–Ø –ò–ù–¢–ï–†–¨–ï–†–ê –∑–∞–ø—É—â–µ–Ω–∞ —Å', allItems.length, '—Ä–µ–∞–ª—å–Ω—ã–º–∏ 3D –º–æ–¥–µ–ª—è–º–∏!');
    </script>
</body>
</html>
